---
title: "promise /aaync await"
date: 2021-11-16
categories: javascript  
---

## Asynchronous Javascript

* ES5 : callback
* ES6 : promise
* ES7 : async/await

## callback

```js
const selectUrl = "http://localhost/prj/todoSelect";
const insertUrl = "http://localhost/prj/todoInsert?contents=xhr";

function ajax1(){
    const xhttp = new XMLHttpRequest();  // ※ 비동기 ※
    xhttp.onload = function() {
        console.log("insert", this.responseText);   //1
        const xhttp1 = new XMLHttpRequest();  // ※ 비동기 ※
        xhttp1.onload = function() {
            console.log("select", this.responseText);   //1
        }
        xhttp1.open("GET", selectUrl);
        xhttp1.send();
    }
    xhttp.open("GET", insertUrl);
    xhttp.send();
}
```

## promise

* 콜백지옥을 벗어나자

```js
function ajax2() {
    fetch(insertUrl)
    .then(data=>data.json())
    .then(function(datas){
        console.log("insert", datas);   
        return fetch(selectUrl);   })
    .then(data=>data.json())    
    .then(data=>console.log("select", data)  )
}
```

## async/await

```js
async function ajax3(){
    let data = await fetch(insertUrl);   //동기식(블록킹함수)
    let result = await data.json(); 
    console.log("insert", result); 

    data = await fetch(selectUrl);
    result = await data.json();
    console.log("select", result);
}
```
